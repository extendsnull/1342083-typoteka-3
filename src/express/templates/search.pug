extends ./layout.pug

block content
  -
    const formatResult = (result, query) => {
      const startIndex = result.indexOf(query);
      const endIndex = startIndex + query.length;
      return `${result.slice(0, startIndex)} <b>${query}</b> ${result.slice(endIndex)}`;
    };

  .wrapper-color
    header.header
      a.header__logo.logo(href="/")
        img.logo__image(src="/img/icons/logo-image-only.svg" alt="логотип Тайпотеки")
        span.logo__name Типотека
      a.button.button--colored.header__button-new(href="/add") Новая запись
      .header__dropdown
        a.button.button--burger.header__burger(href="#") Открыть меню
        ul.navigation.header__navigation
          li.navigation__item
            a(href="/") Пункт меню
          li.navigation__item
            a(href="/") Пункт меню
          li.navigation__item
            a(href="/") Пункт меню
          li.navigation__item
            a(href="/") Пункт меню
      a.header__search.button.button--search(href="/search" aria-label="поиск по сайту")
    main
      - const hasResults = query && !results.length;
      section.search-page
        .search-page__wrapper(class={"search-page__wrapper--empty": hasResults})
          h1 Поиск
          .search.search-page__form
            form(action="/search" method="get")
              label
                input(type="text" name="query" placeholder="Что ищем?" value=query)
              button.search__button.button.button--transparent(type="submit") Найти
            if results.length
              each article in results
                .search__result
                  time.search__date(datetime=article.createdDate) #{article.createdDate}
                  a.search__link(href=`/articles/${article.id}`)!= formatResult(article.title, query)
          if hasResults
            p.search-page__empty Ничего не нашлось
    include ./partials/footer.pug
